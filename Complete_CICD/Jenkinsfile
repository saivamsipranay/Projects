pipeline {
    agent any
    stages {
        stage('Git checkout') {
            steps {
                sh 'echo passed'
            }
        }
        stage('Build and test') {
            agent {
                docker {
                image ' maven:3-eclipse-temurin-17 '
                args '--user root -v /var/run/docker.sock:/var/run/docker.sock' // mount Docker socket to access the host's Docker daemon 
                }
            }
            steps{
                sh 'cd Complete_CICD/ && mvn package'
            }
        }
        stage('Test and Artifact') {
            steps {
                junit '**/surefire-reports/TEST-*.xml'
                archiveArtifacts artifacts: '**/target/*.jar', followSymlinks: false

            }
        }
    }
}